{% extends "AppMainBundle:Default:layout.html.twig" %}

{% block title %}
	Оформление заказа на ЖБИ продукцию
{% endblock %}

{% block description %}
{% endblock %}

{% block content %}
	<h1>Оформление заказа на ЖБИ продукцию</h1>
	{% if order.getProducts() is empty %}
		<h2 class="text-center">Нет выбранных позиций</h2>
		<p class="text-center">Если вы не нашли изделие <a href="/gbi/visual/">в каталоге</a>,
		<br>мы изготовим его <a href="/page/izgotovlenie-gbi-po-chertezham/">по вашим чертежам</a>.  Отправьте их через форму ниже или на почту <a href="mailto:info@stroyprombeton.ru">info@stroyprombeton.ru</a>.</p>
	{% else %}
		<h2>Ваш заказ</h2>
		<table class="table table-bordered table-striped">
			<thead>
				<tr>
					<th class="order-center" width="15%">Код</td>
					<th>Наименование и марка</td>
					<th class="order-product-price">Цена</td>
					<th class="order-product-count">Количество</td>
				</tr>
			</thead>

			<tbody>
				{% set orderTotal = 0 %}
				{% set isOnDemand = false %}
				{% for product in order.getProducts() %}
					<tr>
						<td class="order-center">
							{% if product.model.getNomen() %}
								{{ product.model.getNomen() }}
							{% else %}
								-
							{% endif %}
						</td>
						<td>
							<a href="{{ path('app_catalog_product', {'id': product.model.getId()}) }}">{{ product.model }}</a>
						</td>
						<td class="order-product-price">
							{% if product.model.getPrice() %}
								{{ product.model.getPriceRounded()|number_format(0, '.', ' ') }} руб.
								{% set orderTotal = orderTotal + product.model.getPriceRounded()*product.count %}
							{% else %}
								По запросу
								{% set isOnDemand = true %}
							{% endif %}
						</td>
						<td class="order-product-count">
							{{ product.count }} шт.
						</td>
					</tr>
				{% endfor %}
				<tr>
					<td class="order-total" colspan="2">Итого:</td>
					<td class="order-product-price">
						{% if orderTotal > 0 %}
							{{ orderTotal|number_format(0, '.', ' ') }} руб.
							{% if isOnDemand %}
							+ По запросу
							{% endif %}
						{% else %}
							По запросу
						{% endif %}
					</td>
					<td class="order-product-count">
					</td>
				</tr>
			</tbody>
		</table>
	{% endif %}

	<h2>Контактная информация</h2>
	<form action="{{ path('app_catalog_order') }}" method="post" {{ form_enctype(form) }} id="shop-order-form">
		{{ form_errors(form) }}
		<table class="shop-order-table">
			<tr>
				<td>Ваше имя:<sup>*</sup></td>
				<td>{{ form_widget(form.person) }}</td>
			</tr>
			<tr>
				<td>Контактный телефон:<sup>*</sup></td>
				<td>
					{{ form_widget(form.phone) }}
					<div class="form-error">
						{{ form_errors(form.phone) }}
					</div>
				</td>
			</tr>
			<tr>
				<td>Электронный адрес (Е-mail):<sup>*</sup></td>
				<td>{{ form_widget(form.email) }}</td>
			</tr>
			<tr>
				<td>Полное название организации:<sup>*</sup></td>
				<td>{{ form_widget(form.company) }}</td>
			</tr>
			<tr>
				<td>Адрес поставки:</td>
				<td>{{ form_widget(form.deliveryAddress) }}</td>
			</tr>
			<tr>
				<td>Комментарий к заказу:</td>
				<td>{{ form_widget(form.comment) }}</td>
			</tr>
			{#<tr>#}
			{#<td>Приложить файл:</td>#}
			{#<td>#}
			{#<div>#}
			{#<div class="attach_field">#}
			{#<div>#}
			{#<input type="file" name="attachment[]" accept="text/plain, application/msword, text/richtext, application/x-compressed" value="/">#}
			{#</div>#}
			{#</div>#}
			{#<a href="javascript:;" class="add_attach_field" style="display: none;">Прикрепить ещё файл</a>#}
			{#</div>#}
			{#</td>#}
			{#</tr>#}
			<tr>
				<td>Приложить файл:</td>
				<td class="td-submit">
					{{ form_widget(form.file) }}
					<input type="submit" name="submit" class="button btn btn-danger btn-order-send" value="Отправить заказ">
					<p class="muted">Максимальный размер файла - 50 Мб</p>
				</td>
			</tr>
			<tr>
				<td></td>
				<td class="form-order order-warning shipping">
					<div class="dostavka-gbi">
						<p>
							Варианты поставки
						</p>
						<ul>
							<li>Доставка автотранспортом компании</li>
							<li>Доставка по железной дороге</li>
							<li>Самовывоз со склада в Санкт-Петербурге и Ленинградской области</li>
						</ul>
					</div>
					<div class="dostavka-gbi">
						<p>
							Стоимость доставки
						</p>
						<ul>
							<li>Цена доставки по Санкт-Петербургу <span class="price">от 6000 руб.</span></li>
							<li>Цена доставки по Ленинградской области <span class="price">от 10000 руб.</span></li>
							<li>Цена доставки в другие регионы России <span class="price">от 20000 руб.</span></li>
						</ul>
					</div>
				</td>
			</tr>
		</table>
	</form>
{% endblock %}